/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var $=Object.defineProperty;var re=Object.getOwnPropertyDescriptor;var ie=Object.getOwnPropertyNames;var oe=Object.prototype.hasOwnProperty;var ce=(a,s)=>{for(var e in s)$(a,e,{get:s[e],enumerable:!0})},de=(a,s,e,t)=>{if(s&&typeof s=="object"||typeof s=="function")for(let n of ie(s))!oe.call(a,n)&&n!==e&&$(a,n,{get:()=>s[n],enumerable:!(t=re(s,n))||t.enumerable});return a};var le=a=>de($({},"__esModule",{value:!0}),a);var ye={};ce(ye,{default:()=>H});module.exports=le(ye);var T=require("obsidian");var me={sourceMode:"tag",tagName:"flashcard",folderName:"Flashcards",isBlurFlashcardText:!0,openInPreviewMode:!0};async function _(a){let s=await a.loadData();return Object.assign({},me,s!=null?s:{})}async function Y(a,s){await a.saveData(s)}var y=require("obsidian");var h={CARD_UPDATED:"memmaster:card-updated",CARD_CREATED:"memmaster:card-created",CARD_DELETED:"memmaster:card-deleted",SETTINGS_UPDATED:"memmaster:settings-updated"};var D=class extends y.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t}display(){let{containerEl:e}=this,{i18n:t}=this.plugin;e.empty(),new y.Setting(e).setName(t.t("settings.flashcardSourceHeading")).setHeading(),new y.Setting(e).setName(t.t("settings.cardSource.name")).setDesc(t.t("settings.cardSource.desc")).addDropdown(n=>n.addOption("tag",t.t("settings.sourceMode.tag")).addOption("folder",t.t("settings.sourceMode.folder")).setValue(this.plugin.settings.sourceMode).onChange(async r=>{this.plugin.settings.sourceMode=r,await this.plugin.saveSettings(),this.display(),this.plugin.events.trigger(h.SETTINGS_UPDATED)})),this.plugin.settings.sourceMode==="tag"&&new y.Setting(e).setName(t.t("settings.tagName.name")).setDesc(t.t("settings.tagName.desc")).addText(n=>n.setPlaceholder(t.t("settings.tagName.placeholder")).setValue(this.plugin.settings.tagName).onChange(async r=>{this.plugin.settings.tagName=r,await this.plugin.saveSettings(),this.plugin.events.trigger(h.SETTINGS_UPDATED)})),this.plugin.settings.sourceMode==="folder"&&new y.Setting(e).setName(t.t("settings.folderName.name")).setDesc(t.t("settings.folderName.desc")).addText(n=>n.setPlaceholder(t.t("settings.folderName.placeholder")).setValue(this.plugin.settings.folderName).onChange(async r=>{this.plugin.settings.folderName=r,await this.plugin.saveSettings(),this.plugin.events.trigger(h.SETTINGS_UPDATED)})),new y.Setting(e).setName(t.t("settings.reviewListHeading")).setHeading(),new y.Setting(e).setName(t.t("settings.isBlurFlashcardText.name")).setDesc(t.t("settings.isBlurFlashcardText.desc")).addToggle(n=>n.setValue(this.plugin.settings.isBlurFlashcardText).onChange(async r=>{this.plugin.settings.isBlurFlashcardText=r,await this.plugin.saveSettings(),this.plugin.events.trigger(h.SETTINGS_UPDATED)})),new y.Setting(e).setName(t.t("settings.openInPreviewMode.name")).setDesc(t.t("settings.openInPreviewMode.desc")).addToggle(n=>n.setValue(this.plugin.settings.openInPreviewMode).onChange(async r=>{this.plugin.settings.openInPreviewMode=r,await this.plugin.saveSettings(),this.plugin.events.trigger(h.SETTINGS_UPDATED)})),new y.Setting(e).setName(t.t("settings.hotkeysHeading")).setDesc(t.t("settings.hotkeysDesc")).setHeading()}};var C=require("obsidian");function R(a){return new Promise(s=>setTimeout(s,a))}function I(a,s){let e=s.split("/"),t=a.split("/");for(let n=0;n<=t.length-e.length;n++){let r=!0;for(let o=0;o<e.length;o++)if(t[n+o]!==e[o]){r=!1;break}if(r)return!0}return!1}function ue(a,s){let e=s.replace(/^#/,""),n=new RegExp(`(^|\\s)#${e}(\\b|$)`,"i").test(a),r=!1,o=a.match(/^---\n([\s\S]*?)\n---/);if(o){let i=o[1].split(`
`).find(d=>d.trim().toLowerCase().startsWith("tags:"));if(i){let d=i.split(":").slice(1).join(":").trim();r=new RegExp(`\\b${e}\\b`,"i").test(d)}}return n||r}async function S(a,s){var t;if(a.settings.sourceMode==="folder"){let r=((t=a.settings.folderName)!=null?t:"").trim().replace(/^\/+|\/+$/g,"");return r?I(s.path,r):!1}let e=await a.app.vault.cachedRead(s);return ue(e,a.settings.tagName)}function pe(a,s){let e=a.match(/^---\n([\s\S]*?)\n---/);if(!e)return null;let t=e[1],n=!1,r=!1,o={nextReview:"",stage:"0",file:s,content:a};return t.split(`
`).forEach(c=>{let i=c.indexOf(":");if(i===-1)return;let d=c.substring(0,i).trim(),u=c.substring(i+1).trim();d==="memmaster-next-review"&&(o.nextReview=u,n=!0),d==="memmaster-stage"&&(o.stage=u,r=!0)}),!n||!r?null:o}function he(a){if(!a.nextReview)return!0;let s=new Date;s.setHours(0,0,0,0);let e=new Date(a.nextReview);return e.setHours(0,0,0,0),e<=s}function ge(a){return a.sort((s,e)=>s.nextReview?e.nextReview?new Date(s.nextReview).getTime()-new Date(e.nextReview).getTime():1:-1)}async function Q(a){let s=a.app.vault.getMarkdownFiles(),e=[];for(let t of s)if(await S(a,t)){let r=await a.app.vault.cachedRead(t),o=pe(r,t),c=o!=null?o:{nextReview:"",stage:"0",file:t,content:r};he(c)&&e.push(c)}return ge(e)}var V=class extends C.ItemView{constructor(e,t){super(e);this.searchQuery="";this.sortOrder="oldest-first";this.documentClickHandler=null;this.plugin=t}getViewType(){return V.VIEW_TYPE}getDisplayText(){return this.plugin.i18n.t("reviewList.viewTitle")}async renderContent(){let e=this.contentEl;e.empty();let t=e.createDiv({cls:"mm-search-container"}),n=t.createDiv({cls:"mm-search-wrapper"}),r=n.createEl("span",{cls:"mm-search-icon"});(0,C.setIcon)(r,"search"),n.createEl("input",{type:"text",cls:"mm-search-input",placeholder:this.plugin.i18n.t("reviewList.searchPlaceholder"),value:this.searchQuery}).addEventListener("input",m=>{this.searchQuery=m.target.value.toLowerCase(),this.filterCards()});let c=t.createDiv({cls:"mm-sort-wrapper"});c.createEl("label",{cls:"mm-sort-label",text:this.plugin.i18n.t("reviewList.sortLabel")});let i=c.createDiv({cls:"mm-custom-dropdown"}),d=i.createDiv({cls:"mm-dropdown-selected"}),u=d.createEl("span",{cls:"mm-dropdown-selected-text",text:this.sortOrder==="oldest-first"?this.plugin.i18n.t("reviewList.sortOldestFirst"):this.plugin.i18n.t("reviewList.sortNewestFirst")}),f=d.createEl("span",{cls:"mm-dropdown-arrow"});(0,C.setIcon)(f,"chevron-down");let p=i.createDiv({cls:"mm-dropdown-options"}),g=i.createDiv({cls:"mm-dropdown-border"});[{value:"oldest-first",text:this.plugin.i18n.t("reviewList.sortOldestFirst")},{value:"newest-first",text:this.plugin.i18n.t("reviewList.sortNewestFirst")}].forEach(m=>{let l=p.createDiv({cls:`mm-dropdown-option ${this.sortOrder===m.value?"mm-dropdown-option-selected":""}`,attr:{"data-value":m.value}});l.setText(m.text),l.addEventListener("click",E=>{E.stopPropagation(),this.sortOrder=m.value,u.setText(m.text),p.querySelectorAll(".mm-dropdown-option").forEach(v=>{v.removeClass("mm-dropdown-option-selected")}),l.addClass("mm-dropdown-option-selected"),i.removeClass("mm-dropdown-open"),this.sortCards()})}),d.addEventListener("click",m=>{m.stopPropagation();let l=!i.hasClass("mm-dropdown-open");i.toggleClass("mm-dropdown-open",l),l&&requestAnimationFrame(()=>{let E=p.offsetHeight;g.style.setProperty("--dropdown-options-height",`${E}px`)})}),this.documentClickHandler&&document.removeEventListener("click",this.documentClickHandler),this.documentClickHandler=()=>{i.removeClass("mm-dropdown-open")},document.addEventListener("click",this.documentClickHandler),d.addEventListener("mousemove",m=>{if(!i.hasClass("mm-dropdown-open")){let l=d.getBoundingClientRect(),E=(m.clientX-l.left)/l.width*100,v=(m.clientY-l.top)/l.height*100;d.style.setProperty("--mouse-x",`${E}%`),d.style.setProperty("--mouse-y",`${v}%`)}}),i.addEventListener("mousemove",m=>{if(i.hasClass("mm-dropdown-open")){let l=d.getBoundingClientRect(),E=p.getBoundingClientRect(),v=l.top,P=l.left,G=l.right,q=E.bottom,N=G-P,j=q-v,B=(m.clientX-P)/N*100,A=(m.clientY-v)/j*100;g.style.setProperty("--mouse-x",`${B}%`),g.style.setProperty("--mouse-y",`${A}%`)}});let ee=e.createDiv({cls:"mm-card-grid"}),W=await Q(this.plugin);if(W.length===0){e.createDiv({cls:"mm-no-flashcards"}).setText(this.plugin.i18n.t("reviewList.noFlashcards"));return}e.createDiv({cls:"mm-no-search-results mm-hidden"}).setText(this.plugin.i18n.t("reviewList.noSearchResults"));for(let m of W){let l=ee.createDiv({cls:"mm-card"}),E=this.plugin.settings.isBlurFlashcardText?"mm-blur-enabled":"mm-blur-disabled";l.classList.add(E),l.setAttribute("data-filename",m.file.basename.toLowerCase()),l.setAttribute("data-content",m.content.toLowerCase());let v=0;if(m.nextReview){let w=new Date(m.nextReview);v=Math.floor((new Date().getTime()-w.getTime())/(1e3*60*60*24))}l.setAttribute("data-overdue-days",v.toString());let P=l.createDiv({cls:"mm-card-header"});P.createEl("h4",{text:m.file.basename}),m.nextReview&&P.createEl("span",{cls:"mm-review-info",text:v>0?this.plugin.i18n.t("reviewList.overdueByDays",{days:v.toString()}):this.plugin.i18n.t("reviewList.dueToday")});let N=m.content.split(`
`).filter(w=>{let M=w.trim();return/^#+\s/.test(M)?!1:w.includes("#")}).flatMap(w=>w.split(/\s+/).filter(M=>M.startsWith("#")&&M.length>1&&M[1]!=="#"));l.setAttribute("data-tags",N.join(" ").toLowerCase());let B=m.content.replace(/^---[\s\S]*?---/,"").replace(/#[^\s#]+/g,"").replace(/\n+/g," ").trim().slice(0,128),A=l.createDiv({cls:"mm-card-content"}),te=A.createDiv({cls:"mm-card-tags"});N.forEach(w=>{te.createEl("p",{text:w})}),A.createEl("p",{cls:"mm-card-text",text:B});let se=l.createEl("span",{cls:"mm-open-card-button"});(0,C.setIcon)(se,"eye"),l.addEventListener("click",()=>{this.openCardFile(m.file.path)}),l.addEventListener("mousemove",w=>{let M=l.getBoundingClientRect(),ae=(w.clientX-M.left)/M.width*100,ne=(w.clientY-M.top)/M.height*100;l.style.setProperty("--mouse-x",`${ae}%`),l.style.setProperty("--mouse-y",`${ne}%`)})}this.searchQuery&&this.filterCards(),this.sortCards()}filterCards(){let e=this.contentEl.querySelectorAll(".mm-card"),t=this.contentEl.querySelector(".mm-no-search-results"),n=this.searchQuery,r=!1;e.forEach(o=>{let c=o.getAttribute("data-filename")||"",i=o.getAttribute("data-content")||"",d=o.getAttribute("data-tags")||"";c.includes(n)||i.includes(n)||d.includes(n)?(o.removeClass("mm-hidden"),r=!0):o.addClass("mm-hidden")}),t&&(!r&&n.length>0?t.removeClass("mm-hidden"):t.addClass("mm-hidden"))}sortCards(){let e=this.contentEl.querySelector(".mm-card-grid");if(!e)return;let t=Array.from(e.querySelectorAll(".mm-card"));t.sort((n,r)=>{let o=parseInt(n.getAttribute("data-overdue-days")||"0"),c=parseInt(r.getAttribute("data-overdue-days")||"0");return this.sortOrder==="oldest-first"?c-o:o-c}),t.forEach(n=>e.appendChild(n))}async openCardFile(e){await this.app.workspace.openLinkText(e,"/",!1),this.plugin.settings.openInPreviewMode&&setTimeout(()=>{var n;let t=this.app.workspace.getActiveViewOfType(C.MarkdownView);if(t&&((n=t.file)==null?void 0:n.path)===e){let o=this.app.workspace.getLeavesOfType("markdown").find(c=>c.view===t);if(o){let c=o.getViewState();o.setViewState({type:"markdown",state:{...c.state,mode:"preview"}})}}},100)}async onOpen(){this.containerEl.addClass("mm-view"),await this.renderContent();let e=()=>{this.renderContent()};this.registerEvent(this.app.workspace.on("active-leaf-change",t=>{(t==null?void 0:t.view)instanceof V&&t.view===this&&e()})),this.registerEvent(this.plugin.events.on(h.CARD_UPDATED,e)),this.registerEvent(this.plugin.events.on(h.SETTINGS_UPDATED,e))}async onClose(){this.documentClickHandler&&(document.removeEventListener("click",this.documentClickHandler),this.documentClickHandler=null),this.containerEl.empty(),await Promise.resolve()}},b=V;b.VIEW_TYPE="review-list-view";var F=require("obsidian");function X(a){let s=a.match(/^---\n([\s\S]*?)\n---/),e=s?s[1]:"",t=s?a.replace(s[0],"").trim():a,n={};return e.split(`
`).forEach(r=>{let o=r.indexOf(":");if(o!==-1){let c=r.substring(0,o).trim(),i=r.substring(o+1).trim();c&&i&&(n[c]=i)}}),{metadata:n,body:t}}async function x(a,s,e){let t=await a.app.vault.read(s),{metadata:n,body:r}=X(t),o=new Date,c,i=parseInt(n["memmaster-stage"]||"0");if(e==="easy"?(c=Math.pow(2,i),i++):e==="medium"?(c=Math.pow(1.5,i),i++):e==="hard"?(c=Math.max(1,Math.floor(Math.pow(1.2,i))),i++):(c=1,i++),i>10){await a.app.vault.modify(s,r),new F.Notice(a.i18n.t("notices.cardMastered")),a.events.trigger(h.CARD_UPDATED);return}let d=new Date(o.getTime()+c*24*60*60*1e3);n["memmaster-next-review"]=d.toISOString().split("T")[0],n["memmaster-stage"]=i.toString();let u=`---
`+Object.entries(n).map(([f,p])=>`${f}: ${p}`).join(`
`)+`
---
`;await a.app.vault.modify(s,u+`
`+r),new F.Notice(a.i18n.t("notices.cardUpdated",{date:n["memmaster-next-review"]})),a.events.trigger(h.CARD_UPDATED)}async function z(a,s){let e=await a.app.vault.read(s),{metadata:t,body:n}=X(e),r=new Date;if(t["memmaster-next-review"]=r.toISOString().split("T")[0],t["memmaster-stage"]="0",a.settings.sourceMode==="tag"){let o=a.settings.tagName||"flashcard",c=o.startsWith("#")?o:`#${o}`;if(new RegExp(`(^|\\s)${c.replace("#","\\#")}(\\b|$)`,"i").test(e))return new F.Notice(a.i18n.t("notices.alreadyFlashcard")),!1;let d=!1;if(t.tags&&t.tags.includes(o)&&(d=!0),d)return new F.Notice(a.i18n.t("notices.alreadyFlashcard")),!1;let u=n.replace(/^\n+/,"").replace(/\n+$/,"");u.length>0?u=c+`

`+u:u=c+`
`;let f=`---
`+Object.entries(t).map(([p,g])=>`${p}: ${g}`).join(`
`)+`
---`;return await a.app.vault.modify(s,f+`
`+u),new F.Notice(a.i18n.t("notices.flashcardCreated")+" - "+a.i18n.t("notices.tagAdded",{tag:c})),a.events.trigger(h.CARD_UPDATED),!0}else if(a.settings.sourceMode==="folder"){let c=(a.settings.folderName||"Flashcards").trim().replace(/^\/+|\/+$/g,"");if(I(s.path,c))return new F.Notice(a.i18n.t("notices.alreadyFlashcard")),!1;a.app.vault.getAbstractFileByPath(c)||await a.app.vault.createFolder(c);let d=`${c}/${s.name}`,u=`---
`+Object.entries(t).map(([f,p])=>`${f}: ${p}`).join(`
`)+`
---
`;return await a.app.vault.modify(s,u+`
`+n),await a.app.fileManager.renameFile(s,d),new F.Notice(a.i18n.t("notices.flashcardCreated")+" - "+a.i18n.t("notices.movedToFolder",{folder:c})),a.events.trigger(h.CARD_UPDATED),!0}return!1}function fe(a,s){let e=document.createElement("div");e.className="mm-estimation-card-buttons-container";let t=document.createElement("p");t.className="mm-estimation-card-text",t.textContent=s.i18n.t("reviewFlashcard.difficultyQuestion");let n=document.createElement("div");n.className="mm-estimation-card-buttons-block";let r=document.createElement("button");r.className="mm-estimation-card-button mm-easy-button",r.textContent=s.i18n.t("reviewFlashcard.easy"),r.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation(),x(s,a,"easy")});let o=document.createElement("button");o.className="mm-estimation-card-button mm-medium-button",o.textContent=s.i18n.t("reviewFlashcard.medium"),o.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation(),x(s,a,"medium")});let c=document.createElement("button");return c.className="mm-estimation-card-button mm-hard-button",c.textContent=s.i18n.t("reviewFlashcard.hard"),c.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation(),x(s,a,"hard")}),n.appendChild(r),n.appendChild(o),n.appendChild(c),e.appendChild(t),e.appendChild(n),e.addEventListener("mousemove",i=>{let d=e.getBoundingClientRect(),u=(i.clientX-d.left)/d.width*100,f=(i.clientY-d.top)/d.height*100;e.style.setProperty("--mouse-x",`${u}%`),e.style.setProperty("--mouse-y",`${f}%`)}),e}async function L(a,s,e={}){var u,f;let{delay:t=0,cleanupMisplaced:n=!0,removeIfNoTag:r=!0}=e;if(t>0&&await R(t),!a.file)return;if(!await S(s,a.file)){r&&document.querySelectorAll(".mm-estimation-card-buttons-container").forEach(g=>g.remove());return}let i=((f=(u=a.previewMode)==null?void 0:u.containerEl)!=null?f:a.containerEl).querySelectorAll(".markdown-preview-section"),d=a.file;i.forEach(p=>{let g=p.querySelector(".mm-estimation-card-buttons-container");if(n&&g&&g.parentElement!==p&&(g.remove(),g=null),!g){let U=fe(d,s);p.appendChild(U)}})}var Z=require("obsidian");var J={ribbonIcon:{openReviewFlashcards:"Open repetition flashcards"},commands:{openReviewListView:"Open Review List View",markAsEasy:"Mark current card as Easy",markAsMedium:"Mark current card as Medium",markAsHard:"Mark current card as Hard",makeFlashcard:"Make current document a flashcard"},settings:{flashcardSourceHeading:"Flashcard source settings",cardSource:{name:"Card source",desc:"Choose how to find flashcards for review: by tag or by folder location"},tagName:{name:"Tag name",desc:"Enter the tag name to use",placeholder:"#flashcard"},folderName:{name:"Folder name",desc:"Enter the folder path to use",placeholder:"Flashcards"},reviewListHeading:"Review list settings",isBlurFlashcardText:{name:"Blur flashcard text",desc:"Blur flashcard content in review list until mouse hover"},openInPreviewMode:{name:"Open cards in reading mode",desc:"Open flashcards from review list in reading mode (preview). Important: enabling this setting is required for review buttons to appear on cards."},hotkeysHeading:"Hotkeys settings",hotkeysDesc:"Configure keyboard shortcuts for quick card review. Set hotkeys in Settings > Hotkeys > MemMaster.",sourceMode:{tag:"Tag",folder:"Folder"}},reviewFlashcard:{difficultyQuestion:"How difficult was this card?",easy:"Easy",medium:"Medium",hard:"Hard"},reviewList:{viewTitle:"Repetition flashcards",searchPlaceholder:"Search flashcards...",noFlashcards:"No flashcards due for review.",noSearchResults:"No flashcards found matching your search.",overdueByDays:"Overdue by {{days}} days",dueToday:"Due today",sortLabel:"Sort:",sortOldestFirst:"Most overdue first",sortNewestFirst:"Least overdue first"},notices:{notAFlashcard:"This document is not a flashcard",noActiveFile:"No active file",flashcardCreated:"Document marked as flashcard",tagAdded:"Tag added: {{tag}}",movedToFolder:"Moved to folder: {{folder}}",alreadyFlashcard:"This document is already a flashcard",cardMastered:"Card mastered! Metadata cleared.",cardUpdated:"Updated card: next review on {{date}}"}};var K={ribbonIcon:{openReviewFlashcards:"\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0438 \u0434\u043B\u044F \u043F\u043E\u0432\u0442\u043E\u0440\u0435\u043D\u0438\u044F"},commands:{openReviewListView:"\u041E\u0442\u043A\u0440\u044B\u0442\u044C \u0441\u043F\u0438\u0441\u043E\u043A \u0434\u043B\u044F \u043F\u043E\u0432\u0442\u043E\u0440\u0435\u043D\u0438\u044F",markAsEasy:"\u041E\u0442\u043C\u0435\u0442\u0438\u0442\u044C \u0442\u0435\u043A\u0443\u0449\u0443\u044E \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0443 \u043A\u0430\u043A \u041B\u0435\u0433\u043A\u0430\u044F",markAsMedium:"\u041E\u0442\u043C\u0435\u0442\u0438\u0442\u044C \u0442\u0435\u043A\u0443\u0449\u0443\u044E \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0443 \u043A\u0430\u043A \u0421\u0440\u0435\u0434\u043D\u044F\u044F",markAsHard:"\u041E\u0442\u043C\u0435\u0442\u0438\u0442\u044C \u0442\u0435\u043A\u0443\u0449\u0443\u044E \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0443 \u043A\u0430\u043A \u0421\u043B\u043E\u0436\u043D\u0430\u044F",makeFlashcard:"\u0421\u0434\u0435\u043B\u0430\u0442\u044C \u0442\u0435\u043A\u0443\u0449\u0438\u0439 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442 \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u043E\u0439"},settings:{flashcardSourceHeading:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 \u0438\u0441\u0442\u043E\u0447\u043D\u0438\u043A\u0430 \u043A\u0430\u0440\u0442\u043E\u0447\u0435\u043A",cardSource:{name:"\u0418\u0441\u0442\u043E\u0447\u043D\u0438\u043A \u043A\u0430\u0440\u0442\u043E\u0447\u0435\u043A",desc:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043F\u043E\u0441\u043E\u0431 \u043F\u043E\u0438\u0441\u043A\u0430 \u043A\u0430\u0440\u0442\u043E\u0447\u0435\u043A \u0434\u043B\u044F \u043F\u043E\u0432\u0442\u043E\u0440\u0435\u043D\u0438\u044F: \u043F\u043E \u0442\u0435\u0433\u0443 \u0438\u043B\u0438 \u043F\u043E \u043F\u0430\u043F\u043A\u0435"},tagName:{name:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0442\u0435\u0433\u0430",desc:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0442\u0435\u0433\u0430 \u0434\u043B\u044F \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u044F",placeholder:"#\u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0430"},folderName:{name:"\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043F\u0430\u043F\u043A\u0438",desc:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043F\u0443\u0442\u044C \u043A \u043F\u0430\u043F\u043A\u0435 \u0434\u043B\u044F \u0438\u0441\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u043D\u0438\u044F",placeholder:"\u041A\u0430\u0440\u0442\u043E\u0447\u043A\u0438"},reviewListHeading:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 \u0441\u043F\u0438\u0441\u043A\u0430 \u043F\u043E\u0432\u0442\u043E\u0440\u0435\u043D\u0438\u0439",isBlurFlashcardText:{name:"\u0420\u0430\u0437\u043C\u044B\u0442\u044C \u0442\u0435\u043A\u0441\u0442 \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0438",desc:"\u0420\u0430\u0437\u043C\u044B\u0432\u0430\u0442\u044C \u0441\u043E\u0434\u0435\u0440\u0436\u0438\u043C\u043E\u0435 \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0438 \u0432 \u0441\u043F\u0438\u0441\u043A\u0435 \u043F\u043E\u0432\u0442\u043E\u0440\u0435\u043D\u0438\u0439 \u0434\u043E \u043D\u0430\u0432\u0435\u0434\u0435\u043D\u0438\u044F \u043C\u044B\u0448\u0438"},openInPreviewMode:{name:"\u041E\u0442\u043A\u0440\u044B\u0432\u0430\u0442\u044C \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0438 \u0432 \u0440\u0435\u0436\u0438\u043C\u0435 \u0447\u0442\u0435\u043D\u0438\u044F",desc:"\u041E\u0442\u043A\u0440\u044B\u0432\u0430\u0442\u044C \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0438 \u0438\u0437 \u0441\u043F\u0438\u0441\u043A\u0430 \u043F\u043E\u0432\u0442\u043E\u0440\u0435\u043D\u0438\u0439 \u0432 \u0440\u0435\u0436\u0438\u043C\u0435 \u0447\u0442\u0435\u043D\u0438\u044F (preview). \u0412\u0430\u0436\u043D\u043E: \u0432\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u0435 \u044D\u0442\u043E\u0439 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 \u043D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u0434\u043B\u044F \u043F\u043E\u044F\u0432\u043B\u0435\u043D\u0438\u044F \u043A\u043D\u043E\u043F\u043E\u043A \u043F\u043E\u0432\u0442\u043E\u0440\u0435\u043D\u0438\u044F \u043D\u0430 \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0430\u0445."},hotkeysHeading:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 \u0433\u043E\u0440\u044F\u0447\u0438\u0445 \u043A\u043B\u0430\u0432\u0438\u0448",hotkeysDesc:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u0442\u0435 \u0441\u043E\u0447\u0435\u0442\u0430\u043D\u0438\u044F \u043A\u043B\u0430\u0432\u0438\u0448 \u0434\u043B\u044F \u0431\u044B\u0441\u0442\u0440\u043E\u0433\u043E \u043F\u043E\u0432\u0442\u043E\u0440\u0435\u043D\u0438\u044F \u043A\u0430\u0440\u0442\u043E\u0447\u0435\u043A. \u041D\u0430\u0437\u043D\u0430\u0447\u044C\u0442\u0435 \u0433\u043E\u0440\u044F\u0447\u0438\u0435 \u043A\u043B\u0430\u0432\u0438\u0448\u0438 \u0432 \u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 > \u0413\u043E\u0440\u044F\u0447\u0438\u0435 \u043A\u043B\u0430\u0432\u0438\u0448\u0438 > MemMaster.",sourceMode:{tag:"\u0422\u0435\u0433",folder:"\u041F\u0430\u043F\u043A\u0430"}},reviewFlashcard:{difficultyQuestion:"\u041D\u0430\u0441\u043A\u043E\u043B\u044C\u043A\u043E \u0441\u043B\u043E\u0436\u043D\u043E\u0439 \u0431\u044B\u043B\u0430 \u044D\u0442\u0430 \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0430?",easy:"\u041B\u0435\u0433\u043A\u043E",medium:"\u0421\u0440\u0435\u0434\u043D\u0435",hard:"\u0421\u043B\u043E\u0436\u043D\u043E"},reviewList:{viewTitle:"\u041A\u0430\u0440\u0442\u043E\u0447\u043A\u0438 \u0434\u043B\u044F \u043F\u043E\u0432\u0442\u043E\u0440\u0435\u043D\u0438\u044F",searchPlaceholder:"\u041F\u043E\u0438\u0441\u043A \u043A\u0430\u0440\u0442\u043E\u0447\u0435\u043A...",noFlashcards:"\u041D\u0435\u0442 \u043A\u0430\u0440\u0442\u043E\u0447\u0435\u043A \u0434\u043B\u044F \u043F\u043E\u0432\u0442\u043E\u0440\u0435\u043D\u0438\u044F.",noSearchResults:"\u041A\u0430\u0440\u0442\u043E\u0447\u043A\u0438 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u044B.",overdueByDays:"\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043E \u043D\u0430 {{days}} \u0434\u043D.",dueToday:"\u0421\u0435\u0433\u043E\u0434\u043D\u044F",sortLabel:"\u0421\u043E\u0440\u0442\u0438\u0440\u043E\u0432\u043A\u0430:",sortOldestFirst:"\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0441\u0430\u043C\u044B\u0435 \u043F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043D\u044B\u0435",sortNewestFirst:"\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u043D\u0430\u0438\u043C\u0435\u043D\u0435\u0435 \u043F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043D\u044B\u0435"},notices:{notAFlashcard:"\u042D\u0442\u043E\u0442 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442 \u043D\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u043E\u0439",noActiveFile:"\u041D\u0435\u0442 \u0430\u043A\u0442\u0438\u0432\u043D\u043E\u0433\u043E \u0444\u0430\u0439\u043B\u0430",flashcardCreated:"\u0414\u043E\u043A\u0443\u043C\u0435\u043D\u0442 \u043E\u0442\u043C\u0435\u0447\u0435\u043D \u043A\u0430\u043A \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0430",tagAdded:"\u0422\u0435\u0433 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D: {{tag}}",movedToFolder:"\u041F\u0435\u0440\u0435\u043C\u0435\u0449\u0435\u043D\u043E \u0432 \u043F\u0430\u043F\u043A\u0443: {{folder}}",alreadyFlashcard:"\u042D\u0442\u043E\u0442 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442 \u0443\u0436\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u043E\u0439",cardMastered:"\u041A\u0430\u0440\u0442\u043E\u0447\u043A\u0430 \u043E\u0441\u0432\u043E\u0435\u043D\u0430! \u041C\u0435\u0442\u0430\u0434\u0430\u043D\u043D\u044B\u0435 \u043E\u0447\u0438\u0449\u0435\u043D\u044B.",cardUpdated:"\u041A\u0430\u0440\u0442\u043E\u0447\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0430: \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0435\u0435 \u043F\u043E\u0432\u0442\u043E\u0440\u0435\u043D\u0438\u0435 {{date}}"}};var k={en:J,ru:K},O=class{constructor(s){this.locale=this.getObsidianLocale(s),this.translations=k[this.locale]||k.en}getObsidianLocale(s){return Z.moment.locale().startsWith("ru")?"ru":s&&s in k?s:"en"}t(s,e){let t=s.split("."),n=this.translations;for(let r of t)if(n&&typeof n=="object"&&r in n)n=n[r];else return console.warn(`Translation key not found: ${s}`),s;return typeof n!="string"?(console.warn(`Translation value is not a string: ${s}`),s):e?this.interpolate(n,e):n}interpolate(s,e){return s.replace(/\{\{(\w+)\}\}/g,(t,n)=>n in e?String(e[n]):t)}getLocale(){return this.locale}setLocale(s){s in k?(this.locale=s,this.translations=k[s]):(console.warn(`Locale not supported: ${s}, falling back to 'en'`),this.locale="en",this.translations=k.en)}};var H=class extends T.Plugin{async onload(){this.i18n=new O,this.events=new T.Events,this.settings=await _(this),this.observer=new MutationObserver(e=>{let t=this.app.workspace.getActiveViewOfType(T.MarkdownView);t&&L(t,this,{cleanupMisplaced:!0,removeIfNoTag:!0})}),this.registerEvent(this.app.workspace.on("active-leaf-change",async e=>{var t;if(e&&e.view instanceof T.MarkdownView){this.observer.disconnect(),await R(100),await L(e.view,this,{cleanupMisplaced:!0,removeIfNoTag:!0});let n=(t=e.view.previewMode)==null?void 0:t.containerEl;n&&this.observer.observe(n,{childList:!0,subtree:!0})}})),this.registerEvent(this.app.workspace.on("resize",async()=>{let e=this.app.workspace.getActiveViewOfType(T.MarkdownView);e&&await L(e,this,{delay:100,cleanupMisplaced:!1,removeIfNoTag:!1})})),this.registerEvent(this.app.workspace.on("layout-change",async()=>{let e=this.app.workspace.getActiveViewOfType(T.MarkdownView);e&&await L(e,this,{delay:100,cleanupMisplaced:!1,removeIfNoTag:!1})})),this.addRibbonIcon("square-library",this.i18n.t("ribbonIcon.openReviewFlashcards"),()=>{this.activateView()}),this.registerView(b.VIEW_TYPE,e=>new b(e,this)),this.addCommand({id:"open-review-list-view",name:this.i18n.t("commands.openReviewListView"),callback:()=>{this.activateView()}}),this.addCommand({id:"mark-card-easy",name:this.i18n.t("commands.markAsEasy"),checkCallback:e=>{let t=this.app.workspace.getActiveFile();return t?(e||this.markCardWithDifficulty(t,"easy"),!0):!1}}),this.addCommand({id:"mark-card-medium",name:this.i18n.t("commands.markAsMedium"),checkCallback:e=>{let t=this.app.workspace.getActiveFile();return t?(e||this.markCardWithDifficulty(t,"medium"),!0):!1}}),this.addCommand({id:"mark-card-hard",name:this.i18n.t("commands.markAsHard"),checkCallback:e=>{let t=this.app.workspace.getActiveFile();return t?(e||this.markCardWithDifficulty(t,"hard"),!0):!1}}),this.addCommand({id:"make-flashcard",name:this.i18n.t("commands.makeFlashcard"),checkCallback:e=>{let t=this.app.workspace.getActiveFile();return t?(e||this.makeDocumentFlashcard(t),!0):!1}}),this.addSettingTab(new D(this.app,this))}onunload(){this.observer.disconnect()}async activateView(){let e=this.app.workspace.getLeaf(!0);await e.setViewState({type:b.VIEW_TYPE,active:!0}),await this.app.workspace.revealLeaf(e)}async loadSettings(){this.settings=await _(this)}async saveSettings(){await Y(this,this.settings)}async markCardWithDifficulty(e,t){if(!await S(this,e)){new T.Notice(this.i18n.t("notices.notAFlashcard"));return}await x(this,e,t)}async makeDocumentFlashcard(e){await z(this,e)}};
